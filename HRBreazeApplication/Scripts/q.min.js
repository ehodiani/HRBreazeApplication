(function(n){if(typeof bootstrap=="function")bootstrap("promise",n);else if(typeof exports=="object")module.exports=n();else if(typeof define=="function"&&define.amd)define(n);else if(typeof ses!="undefined")if(ses.ok())ses.makeQ=n;else return;else Q=n()})(function(){"use strict";function s(n){var t=Function.call;return function(){return t.apply(n,arguments)}}function ti(n){return ni(n)==="[object StopIteration]"||n instanceof g}function st(n,t){t.stack&&typeof n=="object"&&n!==null&&n.stack&&n.stack.indexOf(nt)===-1&&(n.stack=ht(n.stack)+"\n"+nt+"\n"+ht(t.stack))}function ht(n){for(var r=n.split("\n"),u=[],i,t=0;t<r.length;++t)i=r[t],ri(i)||ii(i)||u.push(i);return u.join("\n")}function ii(n){return n.indexOf("(module.js:")!==-1||n.indexOf("(node.js:")!==-1}function ri(n){var t=/at .+ \((.*):(\d+):\d+\)/.exec(n),r,i;return t?(r=t[1],i=t[2],r===ft&&i>=bt&&i<=wt):!1}function ct(){if(Error.captureStackTrace){var n,t,i=Error.prepareStackTrace;return Error.prepareStackTrace=function(i,r){n=r[1].getFileName(),t=r[1].getLineNumber()},(new Error).stack,Error.prepareStackTrace=i,ft=n,t}}function n(n){return c(n)}function i(){function p(n){s&&(h=c(n),v(s,function(n,t){u(function(){h.promiseDispatch.apply(h,t)})},void 0),s=void 0,a=void 0)}var s=[],a=[],h,l=d(i.prototype),t=d(f.prototype);return t.promiseDispatch=function(n,t,i){var f=r(arguments);s?(s.push(f),t==="when"&&i[1]&&a.push(i[1])):u(function(){h.promiseDispatch.apply(h,f)})},t.valueOf=function(){if(s)return t;var n=o(h);return y(n)&&(h=n),n},Error.captureStackTrace&&n.longStackJumpLimit>0&&(Error.captureStackTrace(t,i),t.stack=t.stack.substring(t.stack.indexOf("\n")+1)),l.promise=t,l.resolve=p,l.fulfill=function(n){p(rt(n))},l.reject=function(n){p(e(n))},l.notify=function(n){s&&v(a,function(t,i){u(function(){i(n)})},void 0)},l}function ui(n){var t=i();return ut(n,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function f(n,t,i,r,u){t===void 0&&(t=function(n){return e(new Error("Promise does not support operation: "+n))});var o=d(f.prototype);return o.promiseDispatch=function(i,r,u){var f;try{f=n[r]?n[r].apply(o,u):t.call(o,r,u)}catch(s){f=e(s)}i&&i(f)},i&&(o.valueOf=i),u&&(o.exception=r),o}function o(n){return y(n)?n.valueOf():n}function y(n){return n&&typeof n.promiseDispatch=="function"}function tt(n){return n&&typeof n.then=="function"}function fi(n){return!it(n)&&!lt(n)}function it(n){return!tt(o(n))}function lt(n){return n=o(n),y(n)&&"exception"in n}function ei(){at||typeof window=="undefined"||window.Touch||!window.console||console.log("Should be empty:",h),at=!0}function e(n){var t=f({when:function(t){if(t){var i=kt(w,this);i!==-1&&(h.splice(i,1),w.splice(i,1))}return t?t(n):this}},function(){return e(n)},function(){return this},n,!0);return ei(),w.push(t),h.push(n),t}function rt(n){return f({when:function(){return n},get:function(t){return n[t]},set:function(t,i){n[t]=i},"delete":function(t){delete n[t]},post:function(t,i){return t===null||t===void 0?n.apply(void 0,i):n[t].apply(n,i)},apply:function(t,i){return n.apply(t,i)},keys:function(){return gt(n)}},void 0,function(){return n})}function c(n){return y(n)?n:(n=o(n),tt(n)?oi(n):rt(n))}function oi(n){var t=i();return u(function(){try{n.then(t.resolve,t.reject,t.notify)}catch(i){t.reject(i)}}),t.promise}function si(n){return f({isDef:function(){}},function(t,i){return p(n,t,i)},function(){return o(n)})}function t(t,r,f,o){function a(n){try{return typeof r=="function"?r(n):n}catch(t){return e(t)}}function v(n){if(typeof f=="function"){st(n,l);try{return f(n)}catch(t){return e(t)}}return e(n)}function y(n){return typeof o=="function"?o(n):n}var s=i(),h=!1,l=c(t);return u(function(){l.promiseDispatch(function(n){h||(h=!0,s.resolve(a(n)))},"when",[function(n){h||(h=!0,s.resolve(v(n)))}])}),l.promiseDispatch(void 0,"when",[void 0,function(t){var i,r=!1;try{i=y(t)}catch(u){if(r=!0,n.onerror)n.onerror(u);else throw u;}r||s.notify(i)}]),s.promise}function vt(n,i,r){return t(n,function(n){return k(n).then(function(n){return i.apply(void 0,n)},r)},r)}function hi(n){return function(){function i(n,i){var s;try{s=u[n](i)}catch(o){return ti(o)?o.value:e(o)}return t(s,r,f)}var u=n.apply(this,arguments),r=i.bind(i,"send"),f=i.bind(i,"throw");return r()}}function ci(n){throw new g(n);}function li(n){return function(){return vt([this,k(arguments)],function(t,i){return n.apply(t,i)})}}function p(n,t,r){var f=i();return u(function(){c(n).promiseDispatch(f.resolve,t,r)}),f.promise}function l(n){return function(t){var i=r(arguments,1);return p(t,n,i)}}function yt(n,t){var i=r(arguments,2);return b(n,t,i)}function a(n,t){return p(n,"apply",[void 0,t])}function ut(n){var t=r(arguments,1);return a(n,t)}function ai(n){var t=r(arguments,1);return function(){var i=t.concat(r(arguments));return p(n,"apply",[this,i])}}function k(n){return t(n,function(n){var u=0,r=i();return v(n,function(i,f,e){it(f)?n[e]=o(f):(++u,t(f,function(t){n[e]=t,--u==0&&r.resolve(n)},r.reject))},void 0),u===0&&r.resolve(n),r.promise})}function vi(n){return t(n,function(n){return n=ot(n,c),t(k(ot(n,function(n){return t(n,et,et)})),function(){return n})})}function pt(n,i){return t(n,void 0,i)}function yi(n,i){return t(n,void 0,void 0,i)}function pi(n,i){return t(n,function(n){return t(i(),function(){return n})},function(n){return t(i(),function(){return e(n)})})}function wi(i,r,f,e){var o=function(t){u(function(){if(st(t,i),n.onerror)n.onerror(t);else throw t;})},s=r||f||e?t(i,r,f,e):i;typeof process=="object"&&process&&process.domain&&(o=process.domain.bind(o)),pt(s,o)}function bi(n,r){var u=i(),f=setTimeout(function(){u.reject(new Error("Timed out after "+r+" ms"))},r);return t(n,function(n){clearTimeout(f),u.resolve(n)},function(n){clearTimeout(f),u.reject(n)},u.notify),u.promise}function ki(n,r){r===void 0&&(r=n,n=void 0);var u=i();return t(n,undefined,undefined,u.notify),setTimeout(function(){u.resolve(n)},r),u.promise}function di(n,t){var f=r(t),u=i();return f.push(u.makeNodeResolver()),a(n,f).fail(u.reject),u.promise}function gi(n){var u=r(arguments,1),t=i();return u.push(t.makeNodeResolver()),a(n,u).fail(t.reject),t.promise}function nr(n){var t=r(arguments,1);return function(){var f=t.concat(r(arguments)),u=i();return f.push(u.makeNodeResolver()),a(n,f).fail(u.reject),u.promise}}function tr(n,t){var u=r(arguments,2);return function(){function o(){return n.apply(t,arguments)}var e=u.concat(r(arguments)),f=i();return e.push(f.makeNodeResolver()),a(o,e).fail(f.reject),f.promise}}function ir(n,t,u){var e=r(u||[]),f=i();return e.push(f.makeNodeResolver()),b(n,t,e).fail(f.reject),f.promise}function rr(n,t){var f=r(arguments,2),u=i();return f.push(u.makeNodeResolver()),b(n,t,f).fail(u.reject),u.promise}function ur(n,t){if(t)n.then(function(n){u(function(){t(null,n)})},function(n){u(function(){t(n)})});else return n}var bt=ct(),ft,et=function(){},u,g,nt,w,h,at,b,wt;typeof process!="undefined"?u=process.nextTick:typeof setImmediate=="function"?u=typeof window!="undefined"?setImmediate.bind(window):setImmediate:function(){function h(){var u,o;if(--n,++e>=r)for(e=0,r*=4,u=i&&Math.min(i-1,r);n<u;)++n,f();while(i)--i,t=t.next,o=t.task,t.task=void 0,o();e=0}var t={task:void 0,next:null},s=t,r=2,n=0,i=0,e=0,f,o;u=function(t){s=s.next={task:t,next:null},n<++i&&n<r&&(++n,f())},typeof MessageChannel!="undefined"?(o=new MessageChannel,o.port1.onmessage=h,f=function(){o.port2.postMessage(0)}):f=function(){setTimeout(h,0)}}();var r=s(Array.prototype.slice),v=s(Array.prototype.reduce||function(n,t){var i=0,r=this.length;if(arguments.length===1)do{if(i in this){t=this[i++];break}if(++i>=r)throw new TypeError;}while(1);for(;i<r;i++)i in this&&(t=n(t,this[i],i));return t}),kt=s(Array.prototype.indexOf||function(n){for(var t=0;t<this.length;t++)if(this[t]===n)return t;return-1}),ot=s(Array.prototype.map||function(n,t){var i=this,r=[];return v(i,function(u,f,e){r.push(n.call(t,f,e,i))},void 0),r}),d=Object.create||function(n){function t(){}return t.prototype=n,new t},dt=s(Object.prototype.hasOwnProperty),gt=Object.keys||function(n){var i=[],t;for(t in n)dt(n,t)&&i.push(t);return i},ni=s(Object.prototype.toString);if(g=typeof ReturnValue!="undefined"?ReturnValue:function(n){this.value=n},n.longStackJumpLimit=1,nt="From previous event:",n.nextTick=u,n.defer=i,i.prototype.makeNodeResolver=function(){var n=this;return function(t,i){t?n.reject(t):arguments.length>2?n.resolve(r(arguments,1)):n.resolve(i)}},n.promise=ui,n.makePromise=f,f.prototype.then=function(n,i,r){return t(this,n,i,r)},f.prototype.thenResolve=function(n){return t(this,function(){return n})},f.prototype.thenReject=function(n){return t(this,function(){throw n;})},v(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","put","set","del","delete","post","send","invoke","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","ncall","napply","nbind","npost","nsend","ninvoke","nodeify"],function(t,i){f.prototype[i]=function(){return n[i].apply(n,[this].concat(r(arguments)))}},void 0),f.prototype.toSource=function(){return this.toString()},f.prototype.toString=function(){return"[object Promise]"},n.nearer=o,n.isPromise=y,n.isPromiseAlike=tt,n.isPending=fi,n.isFulfilled=it,n.isRejected=lt,w=[],h=[],typeof process!="undefined"&&process.on)process.on("exit",function(){for(var n,t=0;t<h.length;t++)n=h[t],n&&typeof n.stack!="undefined"?console.warn("Unhandled rejected promise:",n.stack):console.warn("Unhandled rejected promise (no stack):",n)});return n.reject=e,n.fulfill=rt,n.resolve=c,n.master=si,n.when=t,n.spread=vt,n.async=hi,n["return"]=ci,n.promised=li,n.dispatch=p,n.dispatcher=l,n.get=l("get"),n.set=l("set"),n["delete"]=n.del=l("delete"),b=n.post=l("post"),n.send=yt,n.invoke=yt,n.fapply=a,n["try"]=ut,n.fcall=ut,n.fbind=ai,n.keys=l("keys"),n.all=k,n.allResolved=vi,n["catch"]=n.fail=pt,n.progress=yi,n["finally"]=n.fin=pi,n.done=wi,n.timeout=bi,n.delay=ki,n.nfapply=di,n.nfcall=gi,n.nfbind=nr,n.denodeify=n.nfbind,n.nbind=tr,n.npost=ir,n.nsend=rr,n.ninvoke=n.nsend,n.nodeify=ur,wt=ct(),n});
//@ sourceMappingURL=q.min.js.map